<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Facilitate an IA workshop session">
  <meta name="theme-color" content="#2563eb">
  <title>Workshop Dashboard | IA Workshop App</title>
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="https://images.squarespace-cdn.com/content/v1/6021e9ddb0db996839eb2101/3dd21272-4acc-4995-880d-24b1600c28b8/Copy+of+IA+Logos.png?format=100w"/>
  
  <!-- Tailwind CSS + DaisyUI -->
  <link href="https://cdn.jsdelivr.net/npm/daisyui@4.6.0/dist/full.min.css" rel="stylesheet" type="text/css" />
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Custom Styles -->
  <link rel="stylesheet" href="css/common.css">
  <link rel="stylesheet" href="css/workshop.css">
  
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js" defer></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js" defer></script>
  
  <!-- Jitsi Meet API (loaded dynamically) -->
</head>
<body>
  <!-- Skip to main content (accessibility) -->
  <a href="#main-content" class="skip-link">Skip to main content</a>

  <!-- Loading Overlay -->
  <div id="loading-overlay" class="fixed inset-0 bg-base-300 bg-opacity-90 backdrop-blur-sm z-50 flex items-center justify-center hidden">
    <div class="text-center">
      <span class="loading loading-spinner loading-lg text-primary"></span>
      <p class="loading-text text-base-content mt-4 text-lg">Loading...</p>
    </div>
  </div>

  <!-- Error Toast -->
  <div id="error-message" class="toast toast-top toast-end hidden z-50">
    <div class="alert alert-error">
      <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
      <span></span>
    </div>
  </div>
  
  <!-- Success Toast -->
  <div id="success-message" class="toast toast-top toast-end hidden z-50">
    <div class="alert alert-success">
      <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
      <span></span>
    </div>
  </div>

  <!-- Main Content -->
  <main id="main-content">
    <!-- Create Workshop Screen -->
    <div id="create-screen" class="screen active min-h-screen flex items-center justify-center p-4">
      <div class="card w-full max-w-md bg-base-100 shadow-2xl">
        <div class="card-body">
          <h2 class="card-title text-3xl font-bold text-center justify-center mb-2">Create Workshop</h2>
          <p class="text-center text-base-content/70 mb-6">Start a new interactive workshop session</p>

          <form id="create-form" novalidate>
            <div class="form-control mb-6">
              <label class="label">
                <span class="label-text font-semibold">Your Name <span class="text-error">*</span></span>
              </label>
              <input 
                type="text" 
                id="facilitator-name" 
                placeholder="Enter your name"
                class="input input-bordered input-primary w-full"
                maxlength="50"
                required
              >
              <label class="label">
                <span class="label-text-alt">This will identify you as the facilitator</span>
              </label>
            </div>

            <button 
              type="submit" 
              id="create-button" 
              class="btn btn-primary btn-lg w-full"
            >
              <span class="btn-text">Create Workshop</span>
              <span class="btn-loading hidden">
                <span class="loading loading-spinner loading-sm"></span>
                Creating...
              </span>
            </button>
          </form>

          <div class="divider"></div>

          <div class="collapse collapse-arrow bg-base-200">
            <input type="checkbox" aria-label="Toggle help section" /> 
            <div class="collapse-title font-medium">
              What happens next?
            </div>
            <div class="collapse-content text-sm"> 
              <ul class="list-disc list-inside space-y-2 text-base-content/80">
                <li>A unique 6-character workshop code will be generated</li>
                <li>Share this code with participants to join</li>
                <li>You'll have access to video, participant list, and controls</li>
                <li>Monitor sessions, manage phases, and generate themes</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Workshop Dashboard Screen -->
    <div id="workshop-screen" class="screen hidden h-screen flex flex-col bg-base-200">
      <!-- Workshop Header -->
      <div class="navbar bg-base-100 shadow-md">
        <div class="flex-1">
          <h1 class="text-xl font-bold ml-4">Workshop Dashboard</h1>
          <div class="ml-8 flex items-center gap-3">
            <div class="badge badge-primary badge-lg font-mono text-xl px-6" id="display-workshop-code">ABC123</div>
            <button id="copy-code" class="btn btn-sm btn-circle btn-ghost tooltip tooltip-bottom" data-tip="Copy code" aria-label="Copy room code">
              <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"></path>
              </svg>
            </button>
          </div>
        </div>
        <div class="flex-none gap-3 mr-4">
          <!-- Phase Control -->
          <div class="flex items-center gap-2">
            <span class="text-sm font-semibold">Phase:</span>
            <select id="phase-select" class="select select-bordered select-sm" aria-label="Select workshop phase">
              <option value="0">Phase 1</option>
              <option value="1">Phase 2</option>
              <option value="2">Phase 3</option>
              <option value="3">Phase 4</option>
              <option value="4">Phase 5</option>
            </select>
          </div>
          
          <!-- Timer -->
          <div class="flex items-center gap-2">
            <kbd class="kbd font-mono text-lg" id="timer-display">0:00</kbd>
            <button id="start-timer" class="btn btn-sm btn-primary" aria-label="Start 5 minute timer">
              <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <polygon points="5 3 19 12 5 21 5 3"></polygon>
              </svg>
              5 min
            </button>
            <button id="stop-timer" class="btn btn-sm btn-error" aria-label="Stop timer">
              <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <rect x="6" y="6" width="12" height="12"></rect>
              </svg>
            </button>
          </div>
          
          <!-- Theme Toggle -->
          <button id="theme-toggle" class="btn btn-sm btn-circle btn-ghost" title="Toggle dark mode" aria-label="Toggle dark mode">
            <svg class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <!-- Sun icon -->
              <circle cx="12" cy="12" r="5"/>
              <line x1="12" y1="1" x2="12" y2="3"/>
              <line x1="12" y1="21" x2="12" y2="23"/>
              <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
              <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
              <line x1="1" y1="12" x2="3" y2="12"/>
              <line x1="21" y1="12" x2="23" y2="12"/>
              <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
              <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
            </svg>
          </button>
        </div>
      </div>

      <!-- Main Content Area -->
      <div class="flex flex-1 gap-4 p-4 overflow-hidden">
        <!-- Video Grid -->
        <div class="flex-1 card bg-base-300 shadow-xl overflow-hidden">
          <div id="jitsi-container" class="w-full h-full"></div>
        </div>

        <!-- Sidebar -->
        <div class="w-80 flex flex-col gap-4">
          <!-- Participants Panel -->
          <div class="card bg-base-100 shadow-xl flex-1 overflow-hidden flex flex-col">
            <div class="card-body p-0 flex flex-col h-full">
              <div class="px-6 py-4 border-b border-base-300">
                <h2 class="card-title text-lg">
                  Participants
                  <div class="badge badge-primary" id="participant-count">0</div>
                </h2>
              </div>
              <div id="participants-list" class="flex-1 overflow-y-auto p-4">
                <div class="text-center text-base-content/60 py-8">No participants yet</div>
              </div>
            </div>
          </div>

          <!-- Activity Panel -->
          <div class="card bg-base-100 shadow-xl flex-1 overflow-hidden flex flex-col">
            <div class="card-body p-0 flex flex-col h-full">
              <div class="px-6 py-4 border-b border-base-300">
                <h2 class="card-title text-lg">Activity Log</h2>
              </div>
              <div id="activity-list" class="flex-1 overflow-y-auto p-4 space-y-2">
                <div class="text-center text-base-content/60 py-8">No activity yet</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Footer with Actions -->
      <div class="navbar bg-base-100 border-t border-base-300">
        <div class="flex-1">
          <input 
            type="text" 
            id="share-link" 
            readonly 
            placeholder="Share link will appear here"
            class="input input-bordered input-sm w-96 ml-4 font-mono text-xs"
          >
        </div>
        <div class="flex-none gap-2 mr-4">
          <button id="generate-themes" class="btn btn-primary">
            <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"></path>
            </svg>
            Generate Themes
          </button>
          <button id="end-session" class="btn btn-error">
            <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M18 6L6 18M6 6l12 12"></path>
            </svg>
            End Session
          </button>
        </div>
      </div>
    </div>
  </main>

  <!-- Scripts -->
  <script src="js/config.js"></script>
  <script src="js/utils.js"></script>
  <script src="js/firebase.js"></script>
  <script src="js/workshop.js"></script>
</body>
</html>
